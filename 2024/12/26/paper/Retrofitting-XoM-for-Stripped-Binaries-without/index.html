<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Retrofitting XoM for Stripped Binaries without Embedded Data Relocation 阅读笔记 | PassMoon</title><meta name="author" content="PassMoon"><meta name="copyright" content="PassMoon"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Retrofitting XoM for Stripped Binaries without Embedded Data Relocation 阅读笔记 代码随机化可以有效的防御传统ROP攻击，面对这种防御技术，攻击者通过内存泄露推测随机化的代码布局获得可构成攻击的gadgets，使代码随机化无效。其中JIT-ROP技术在线重复利用内存泄露漏洞，读取代码以收集gadgets，来完成payload构">
<meta property="og:type" content="article">
<meta property="og:title" content="Retrofitting XoM for Stripped Binaries without Embedded Data Relocation 阅读笔记">
<meta property="og:url" content="https://passmoon.github.io/2024/12/26/paper/Retrofitting-XoM-for-Stripped-Binaries-without/index.html">
<meta property="og:site_name" content="PassMoon">
<meta property="og:description" content="Retrofitting XoM for Stripped Binaries without Embedded Data Relocation 阅读笔记 代码随机化可以有效的防御传统ROP攻击，面对这种防御技术，攻击者通过内存泄露推测随机化的代码布局获得可构成攻击的gadgets，使代码随机化无效。其中JIT-ROP技术在线重复利用内存泄露漏洞，读取代码以收集gadgets，来完成payload构">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://passmoon.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2024-12-26T06:45:34.000Z">
<meta property="article:modified_time" content="2024-12-28T12:24:08.103Z">
<meta property="article:author" content="PassMoon">
<meta property="article:tag" content="Paper note">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://passmoon.github.io/img/butterfly-icon.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://passmoon.github.io/2024/12/26/paper/Retrofitting-XoM-for-Stripped-Binaries-without/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><link rel="stylesheet" href="/fonts/logofont.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Retrofitting XoM for Stripped Binaries without Embedded Data Relocation 阅读笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><link rel="stylesheet" href="/fonts/font.css"><meta name="generator" content="Hexo 7.3.0"><link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/butterfly-icon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">PassMoon</span></a><a class="nav-page-title" href="/"><span class="site-name">Retrofitting XoM for Stripped Binaries without Embedded Data Relocation 阅读笔记</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Retrofitting XoM for Stripped Binaries without Embedded Data Relocation 阅读笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-12-26T06:45:34.000Z" title="发表于 2024-12-26 14:45:34">2024-12-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-12-28T12:24:08.103Z" title="更新于 2024-12-28 20:24:08">2024-12-28</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1>Retrofitting XoM for Stripped Binaries without Embedded Data Relocation 阅读笔记</h1>
<p>代码随机化可以有效的防御传统ROP攻击，面对这种防御技术，攻击者通过内存泄露推测随机化的代码布局获得可构成攻击的gadgets，使代码随机化无效。其中JIT-ROP技术在线重复利用内存泄露漏洞，读取代码以收集gadgets，来完成payload构建。Execute-only memory （XoM）技术应运而生，通过管理代码和数据访问权限，限制代码信息泄露防止ROP攻击。如何有效控制代码和数据访问权限的精确和安全成为了重要问题。</p>
<p>其中一种方法是将代码和数据分为两个区域。分离技术可以分为两类：定制编译器和链接器；补充二进制代码文件。但代码和数据混合的情况普遍存在，这些技术并不能完全分离代码和数据，会导致读取合法数据时产生误报，同时现在的CPU也不再有分离代码和数据的缓存，分离技术也会带来额外的开销。</p>
<p>另一中解决思路是将泄露的代码消除，让攻击者无法运行。Destructive Code Read（DCR）在合法的读取代码页数据的操作结束后立即销毁读取的代码，但这个方法会受到代码推理攻击。</p>
<p>总的来说，现有基于XoM的研究方法面临3个缺点：</p>
<ol>
<li>对于传统软件和商业软件的不兼容；</li>
<li>严格划分代码和数据区域降低了软件运行的可靠性；</li>
<li>修改底层架构机制，影响了性能和兼容性。</li>
</ol>
<h1>研究背景</h1>
<h2 id="a-just-in-time-rop">A. Just-In-Time ROP</h2>
<img src="/2024/12/26/paper/Retrofitting-XoM-for-Stripped-Binaries-without/image-20241227185232149.png" class="" title="image-20241227185232149">
<h2 id="b-execute-only-memory-defense">B.Execute-only Memory Defense</h2>
<img src="/2024/12/26/paper/Retrofitting-XoM-for-Stripped-Binaries-without/image-20241227210820485.png" class="" title="image-20241227210820485">
<p>早在 1967 年，Multics 就提出了只执行内存（XoM）的概念。然而，直到 JIT-ROP 作为一种紧迫威胁出现后，现代操作系统、硬件才采用了这一概念。</p>
<p>由于Execute-only Memory Defense是对内存页的访问权限进行管理，仅仅通过软件调度需要很高的开销且容易被攻击。之后在 x86 架构上，英特尔的扩展页表（EPT）硬件虚拟化机制被用来实现仅执行权限，但EPT要求程序在虚拟机中运行。接着英特尔推出的内存保护密钥（MPK）支持有效分离读取和执行权限。尽管硬件支持有了解决方案，现有的研究方法后续兼容性问题也是影响防御方法部署的因素之一，最主要的问题就是代码和数据无法有效分离，XnR 方法是建立在代码页不包含任何数据这一强有力的假设之上，但现实情况很明显不符合这种假设，如手写汇编。</p>
<p>为了<strong>分离数据区和代码区</strong>，编译时转换使用自定义编译器编译源代码，并将代码和数据指定到不同的内存空间。这种方法需要重新编译源代码不能很好的用在COTS二进制上，同时这种方法也不支持转换手写的汇编语言。另一类研究旨在仅通过二进制文件执行 XoM 策略。依靠调试信息（如函数符号和 DWARF）在运行前识别代码段中的数据。在运行期间，具有虚拟地址的代码和数据映射到不同的物理地址上，有效地隔离了代码页和数据页。然后，将代码页的读取操作重定向到单独的数据页。但这种方法可靠性较差，更新静态数据引用和嵌入数据识别都容易出错导致程序运行崩溃。</p>
<p>为了解决 XoM 方法不支持<strong>代码页内合法数据读取的问题</strong>，Heisenbyte提出了一种 XoM 机制的变体，称为破坏性代码读取（DCR）。Heisenbyte 允许泄露内存，但会在读取后立即销毁已泄露的代码，从而防止执行之前泄露的代码。尽管 DCR 成功地支持了代码页内的合法数据读取，但 Snow 等人提出的代码推理攻击彻底破坏了 DCR 的安全保证。代码推理攻击的核心思想是公开一段代码，但不执行它。取而代之的是执行与之密切相关的另一段代码，如在不同内存区域中执行与已公开代码完全相同的副本，或根据已公开代码预测出相关代码。</p>
<h2 id="c-memory-protection-keys">C.Memory Protection Keys</h2>
<p>英特尔内存保护密钥（MPK）是一种硬件功能，可对代码页进行更严格的权限控制，而无需修改页表。MPK 机制使用保护密钥权限寄存器 (PKRU) 来维护与特定页面相关的单个密钥的访问权限。它支持三种不同的页面权限：读写、只读和无访问。MPK 控制内存页面的读写权限，传统权限管理机制则继续管理执行权限。MPK 机制可通过禁用内存页的读写权限，将内存页的权限配置为仅可执行。由于 MPK 密钥被本地化到每个线程，可能会导致同一进程中不同线程的 MPK 密钥不一致。为了确保进程内不同线程之间只执行 MPK 密钥的同步，本文使用了 libmpk 提供的同步原语。</p>
<h2 id="d-内核级-xom-保护"><strong>D.内核级 XoM 保护</strong></h2>
<p>PXoM 和相关工作认为内核是可信计算基础的一部分，因此不针对内核内存泄露提供保护。另一个平行方向是内核级 XoM 保护，因为在某些情况下，内核本身也可能被利用。IskiOS 简单地使用 MPK 撤销内核代码页的读取权限。不过，他们的解决方案不适用于剥离的二进制文件，因为它没有解决合法的嵌入式数据读取问题。</p>
<h1>主要思想</h1>
<p>提出了基于基本块的细粒度访问权限控制策略（读或仅执行）。</p>
<p>本文提出的方法在仅执行的代码页上可以读取合法的数据，利用英特尔硬件特性–内存保护密钥（MPK），在内核级别对代码区和嵌入式数据区的读取请求进行监管，从而将性能开销降至最低。</p>
<p>提出Unidirectional Disassembly方法获得精确的数据范围，定制内核级二进制加载器加载受到PXoM保护的二进制文件和动态审查访问数据请求是否合法的内核级监视器。为了进一步增强性能，开发cache-like的优化策略。</p>
<h1><strong>论文主要贡献</strong></h1>
<ul>
<li>提出了一种新的硬件辅助 XoM 技术–PXoM，它可以加固已剥离的二进制文件，阻止内存泄露企图，并最终防止 JIT-ROP 攻击。利用硬件特性（MPK）确保系统安全方面的一大进步。</li>
<li>新颖的细粒度内存访问控制策略能够克服现有工作的关键局限性，允许在仅可执行内存中读取合法数据，而无需重新定位容易出错的嵌入式数据。</li>
<li>与现有的 XoM 工具相比，PXoM 的运行时开销最小，是现实世界中可以采用的可行的解决方案。</li>
</ul>
<h1>模型假设</h1>
<p>PXoM 的目的是基于一个定义明确的对手模型，通过防止攻击者动态泄露内存来抵御 JIT-ROP。该模型包括以下假设 -</p>
<ul>
<li>W⊕X：目标系统确保可执行权限和可写权限不能共存于同一内存页。这一假设构成了 ROP 防御的基础。否则，攻击者只需直接执行注入的 shellcode，而无需使用 ROP 技术。</li>
<li>随机化： 目标程序使用细粒度的代码随机化技术，使对手无法提前确定受保护程序的内存布局。</li>
<li>控制流劫持： 目标程序很容易受到内存破坏攻击，从而让对手劫持控制流。</li>
<li>透明配置： 对手知道目标系统的配置，也能<strong>访问目标程序的源代码</strong>。</li>
<li>威胁模型不包括侧信道和自修改二进制保护，因为它们超出了本文的研究范围，而且也被其他同行的研究排除在外。</li>
</ul>
<h1>模型设计</h1>
<img src="/2024/12/26/paper/Retrofitting-XoM-for-Stripped-Binaries-without/image-20241227211732818.png" class="" title="image-20241227211732818">
<p>研究延续了将 XoM 移植到剥离二进制文件的研究路线。设计目标之一是避免通过二进制修补重新定位嵌入式数据。为此，开发了一种新的细粒度内存权限控制机制，可以进行合法的数据-代码读取。</p>
<ol>
<li>
<p><strong>细粒度的访问权限控制</strong></p>
<p>在以往的 XoM 方法中，错误地将代码识别为数据（图 3 中的 2）会导致代码无意中移至代码页之外，从而改变程序语义。另一方面，当嵌入数据被误解为代码时，对这些数据的合法读取将被禁止（图 3 中的 1）。这两种错误都会带来严重的崩溃风险。</p>
<img src="/2024/12/26/paper/Retrofitting-XoM-for-Stripped-Binaries-without/image-20241227212621576.png" class="" title="image-20241227212621576">
<p>这种粗粒度的内存权限访问控制不能满足健壮性的要求，作者采用在同一内存页上对不同区域分配不同权限的控制机制解决了上述问题。</p>
</li>
<li>
<p><strong>确定授权读取的区域</strong></p>
<p>为了确定授权读取的区域，我们首先要在运行前识别二进制文件中的所有嵌入数据。为了避免精确识别嵌入数据的内在复杂性，采用了单向反汇编策略（图 2 中的 1）。这种反汇编策略策略不是试图精确识别所有嵌入数据，而是识别嵌入数据的超集，其中包括所有实际嵌入数据和极少量代码。</p>
<img src="/2024/12/26/paper/Retrofitting-XoM-for-Stripped-Binaries-without/image-20241227213951354.png" class="" title="image-20241227213951354">
<p>应用递归遍历算法，从程序入口点开始跟踪控制流，识别位于主要路径上的代码。然而，递归遍历反汇编在处理间接调用和不可达函数时会遇到困难，平均可能遗漏多达 49.35% 的代码，从而导致庞大的嵌入式数据超集。为了进一步减少超集，我们进行了多次额外分析，以发现遗漏的代码入口点，随后对这些已识别的入口点进行递归遍历反汇编。在对每个入口点进行反汇编的过程中，会将识别出的代码排除在超集之外，从而最大限度地减少嵌入式数据超集（图 4(D)）。具体来说，分析包括检查跳转表、帧解卷信息、地址占用函数，并采用函数入口识别启发式方法来识别递归遍历反汇编未触及的其他代码入口点。</p>
<p>获得嵌入式数据超集后，我们将整个超集变为可读，并使用细粒度内存权限控制机制禁止所有剩余可执行区域的读取权限。这就确保了所有合法的嵌入式数据读取都仅限于该超集，而该超集之外的任何代码泄露尝试都会被禁止。</p>
</li>
<li>
<p><strong>ELF文件格式</strong></p>
<p>在 ELF 文件头中使用<code>XOM ENABLE</code>作为 PXoM 特定标志字节 ，以指示程序是否受 PXoM 保护。该字节是<code>EI_PAD</code>数组中的第二个字节，是 ELF 头中 <code>e_ident</code> 的一个字段。通过检查该字节，自定义加载器可以决定是否启用 PXoM 保护。之后，嵌入式数据列表被包含在一个名为 <code>.xom </code>的可选部分中。<code>OPT LIST</code> 和<code>REGR LIST</code>分别代表优化列表和常规列表。</p>
<img src="/2024/12/26/paper/Retrofitting-XoM-for-Stripped-Binaries-without/image-20241227214837628.png" class="" title="image-20241227214837628">
<p>OPT_LIST是存放频繁访问的嵌入数据，对于静态数据超过引用10次会放入表中，动态数据根据异常处理器中实时监视器将数据读取次数超过 100 次的数据放入表中。</p>
</li>
<li>
<p><strong>自定义的加载器</strong></p>
<p>自定义加载器是 PXoM 的内核组件，用于加载受保护的二进制文件并初始化内核中的相关结构。加载器会检查 ELF 头文件中的 <code>XOM ENABLE</code> 标志，如果是，加载器将加载存储在 .xom 部分的嵌入式数据列表（图 2 中的 3），并初始化异常处理程序，以确保代码中数据读取的合法性（图 2 中的 4）。 PXoM 相关的元数据都存储在内核内存中。PXoM 标志、优化列表指针和常规列表指针存储在 task_struct 中。每个进程都有自己的任务结构对象，其中存储了进程的上下文。加载列表后，自定义加载器开始将代码段映射到内存中。在映射过程中，加载器会分配一个仅可执行的 PKey，并用此 PKey 将代码段设置为仅可执行。</p>
</li>
<li>
<p><strong>异常处理器</strong></p>
<p>如果读取请求的地址位于常规列表或优化列表中，异常处理程序将允许该读取请求。否则，读取请求将被拒绝，PXoM 将终止进程并保存上下文信息，以便进一步取证调查。异常处理程序使用 MPK 机制有效检查读取请求的合法性。</p>
<img src="/2024/12/26/paper/Retrofitting-XoM-for-Stripped-Binaries-without/image-20241227220125829.png" class="" title="image-20241227220125829">
<p>在 x86-64 架构上，代码中的数据读取可以使用一条指令访问多个字节，上图为可访问和不可访问的情景。</p>
<p>数据的读取步骤：</p>
<p>1）恢复目标页面的读取权限，允许临时读取。</p>
<p>2）设置单步陷阱标志，只执行读取指令，并在下一条指令时停止。</p>
<p>3）合法读取操作完成后，我们再次撤销代码页的读取权限，并清除单步陷阱标志，恢复程序的正常执行。</p>
</li>
</ol>
<h1>模型评估</h1>
<h2 id="安全评估">安全评估</h2>
<h3 id="a-unidirectional-disassembly-result-analysis">A. Unidirectional Disassembly Result Analysis</h3>
<p>评价指标：</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>C</mi><mo>=</mo><mfrac><mrow><mi>D</mi><mi>i</mi><mi>s</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>d</mi><mi>C</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>B</mi><mi>y</mi><mi>t</mi><mi>e</mi><mi>s</mi></mrow><mrow><mi>R</mi><mi>e</mi><mi>a</mi><mi>l</mi><mi>C</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>B</mi><mi>y</mi><mi>t</mi><mi>e</mi><mi>s</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">CC=\frac{DisassembledCodeBytes}{RealCodeBytes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.4133239999999998em;vertical-align:-0.481108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322159999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight" style="margin-right:0.07153em;">C</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">s</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight" style="margin-right:0.07153em;">C</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mi>C</mi><mo>=</mo><mfrac><mrow><mi>D</mi><mi>i</mi><mi>s</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>d</mi><mrow><mtext> </mtext><mi mathvariant="normal">C</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi><mtext> </mtext><mi mathvariant="normal">B</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow></mrow><mrow><mi>R</mi><mi>e</mi><mi>a</mi><mi>l</mi><mrow><mtext> </mtext><mi mathvariant="normal">C</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">e</mi></mrow><mo>+</mo><mi>E</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>d</mi><mi>d</mi><mi>e</mi><mi>d</mi><mrow><mtext> </mtext><mi mathvariant="normal">D</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">OC=\frac{Disassembled\mathrm{~Code~Bytes}}{Real\mathrm{~Code}+Embedded\mathrm{~Data}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.335547em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322159999999999em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mtight"><span class="mspace nobreak mtight"><span class="mtight"> </span></span><span class="mord mathrm mtight">C</span><span class="mord mathrm mtight">o</span><span class="mord mathrm mtight">d</span><span class="mord mathrm mtight">e</span></span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">E</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">d</span><span class="mord mtight"><span class="mspace nobreak mtight"><span class="mtight"> </span></span><span class="mord mathrm mtight">D</span><span class="mord mathrm mtight">a</span><span class="mord mathrm mtight">t</span><span class="mord mathrm mtight">a</span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">d</span><span class="mord mtight"><span class="mspace nobreak mtight"><span class="mtight"> </span></span><span class="mord mathrm mtight">C</span><span class="mord mathrm mtight">o</span><span class="mord mathrm mtight">d</span><span class="mord mathrm mtight">e</span><span class="mspace nobreak mtight"><span class="mtight"> </span></span><span class="mord mathrm mtight">B</span><span class="mord mathrm mtight" style="margin-right:0.01389em;">y</span><span class="mord mathrm mtight">t</span><span class="mord mathrm mtight">e</span><span class="mord mathrm mtight">s</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<p>嵌入数据块的数量</p>
<p>嵌入数据块的平均大小</p>
<img src="/2024/12/26/paper/Retrofitting-XoM-for-Stripped-Binaries-without/image-20241227221207014.png" class="" title="image-20241227221207014">
<img src="/2024/12/26/paper/Retrofitting-XoM-for-Stripped-Binaries-without/image-20241228103701219.png" class="" title="image-20241228103701219">
<h3 id="b-attack-surface-analysis">B. Attack Surface Analysis</h3>
<p>由于部分代码无法被有效的划分到仅执行权限区域，比较关心这部分代码对于安全的影响。</p>
<p>本文应用 ROP gadget 搜索工具 ROPGadget ，发现可用的gadget 非常稀少，即使是包含大量嵌入式数据的二进制文件也是如此。平均而言，只能从由 287 个小块组成的嵌入数据中提取出 7 个gadget ，这意味着查找gadget 困难且可用的数量少。</p>
<p>如表2，嵌入数据的超集占代码总量的4.71%，则攻击者在内存中试图找到嵌入数据的概率为4.71%，且平均每个数据块为31字节。根据之前的关于构建ROP链的相关论文，泄露的信息不足以构建一个 ROP 链。</p>
<h2 id="性能评估">性能评估</h2>
<img src="/2024/12/26/paper/Retrofitting-XoM-for-Stripped-Binaries-without/image-20241228001859608.png" class="" title="image-20241228001859608">
<p>表 4 显示了与进程创建和页面故障处理有关的内核操作的运行时间。Fork Proc 和 Exec Proc 是使用 fork 和 exec 创建进程的操作。由于加载 XoM 元数据需要额外的步骤，它们导致的开销分别为 0.92% 和 0.60%。Page Fault 显示了页面故障处理的总体开销，开销为 0.52%。最后两个保护故障显示了不触发和触发代码中数据读取合法性检查时的保护故障处理开销。</p>
<img src="/2024/12/26/paper/Retrofitting-XoM-for-Stripped-Binaries-without/image-20241228001908185.png" class="" title="image-20241228001908185">
<p>表 5 显示了标准内核和修改后内核的上下文切换时间。在第一行中，上半部分显示了参与上下文切换的进程数，下半部分显示了每个进程的内存使用量。</p>
<img src="/2024/12/26/paper/Retrofitting-XoM-for-Stripped-Binaries-without/image-20241228001936659.png" class="" title="image-20241228001936659">
<p>图 7 显示了 PXoM 在 SPEC CPU 2017 上造成的运行时间减慢，最右侧的绿色和蓝色条纹柱分别表示开销的平均值和几何平均值。</p>
<img src="/2024/12/26/paper/Retrofitting-XoM-for-Stripped-Binaries-without/image-20241228001948841.png" class="" title="image-20241228001948841">
<p>PXoM 的性能开销主要受两个关键因素的影响： 1) 嵌入数据列表的大小；2) 代码中数据的读取频率。</p>
<p>图 8 显示了在不同的嵌入式数据列表大小（N）下执行不同数量的代码内数据读取所需的时间。横轴表示代码中数据的读取次数，纵轴表示代码中数据的读取时间。根据表2和表3</p>
<img src="/2024/12/26/paper/Retrofitting-XoM-for-Stripped-Binaries-without/image-20241228002001682.png" class="" title="image-20241228002001682">
<p>如图 8 所示，程序对代码中数据的读取强度与由此产生的开销之间存在直接关系，定义了 “读取强度 ”。</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi>I</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>t</mi><mi>y</mi><mo>=</mo><mfrac><mrow><mi mathvariant="normal">#</mi><mi>o</mi><mi>f</mi><mi>R</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi>R</mi><mi>e</mi><mi>q</mi><mi>u</mi><mi>e</mi><mi>s</mi><mi>t</mi><mi>s</mi></mrow><mrow><mi mathvariant="normal">#</mi><mi>o</mi><mi>f</mi><mi>E</mi><mi>x</mi><mi>e</mi><mi>c</mi><mi>u</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>I</mi><mi>n</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>u</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">ReadIntensity=\frac{\#ofReadRequests}{\#ofExecutedInstructions}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault">e</span><span class="mord mathdefault">a</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.25188em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">#</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault">x</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">u</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">#</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault">e</span><span class="mord mathdefault">a</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mord mathdefault">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>图9表示尽管数据读取在程序中作为常用操作，但发生率极低，所以PXoM实际开销可以忽略不计。</p>
<h1>讨论和结论</h1>
<h2 id="内核部分组件安全">内核部分组件安全</h2>
<p>在内核可信计算库中添加代码是有风险的，内核加载二进制文件时，会将“.xom ”部分的内容解析到内核结构中。在此过程中，不适当的检查可能会让攻击者利用内核。因此，在解析该列表时，我们必须进行仔细、严格的检查，以防止缓冲区溢出攻击。此外，我们还在内核中添加了一些指针，用于存储与 XoM 相关的数据。在使用这些指针时，也必须执行严格的检查，以防止出现使用后释放（useafter-free）和双重释放（double-free）等漏洞。另一个潜在威胁是不同线程之间的竞赛条件。当允许读取嵌入数据时，目标代码页会在很短的时间内处于可读状态。如果此时控制权被其他线程接管，则该线程可能会泄露可读内存页。因此，应确保读取操作的权限是原子性的，并且在此操作过程中控制权不能被夺走。</p>
<h2 id="保护动态加载代码">保护动态加载代码</h2>
<p>目前，PXoM 还不能保护动态加载（dlopen）的代码和动态生成的代码，通过利用GNU C 库来保护动态加载的代码。对于动态生成的代码，当 JIT 引擎生成 JIT 编译代码时，我们可以知道所有嵌入数据的位置，因此我们可以在 JIT 引擎中将这些位置标记为可读，并对生成的代码应用 PXoM 保护。</p>
<h2 id="内存保护密钥-mpk-的安全性">内存保护密钥（MPK）的安全性</h2>
<p>内存保护密钥（MPK）为管理内存权限提供了一种有效的机制，但它自身的安全隐患也引起了人们的关注。</p>
<h2 id="结论">结论</h2>
<p>只执行内存（XoM）是防止内存泄露和反击 JIT-ROP 攻击的一种有前途的解决方案。本文介绍的 PXoM 是一种将 XoM 移植到未嵌入数据重定位的剥离二进制文件中的技术。与现有方法不同，PXoM 无需进行编译时转换或二进制修补，即可在内存页内实现细粒度内存权限控制。对大型程序的性能评估表明，运行时开销可以忽略不计，安全评估表明 PXoM 在现实世界中是可行的，有可能使内存防御格局发生有利于防御者的变化。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://passmoon.github.io">PassMoon</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://passmoon.github.io/2024/12/26/paper/Retrofitting-XoM-for-Stripped-Binaries-without/">https://passmoon.github.io/2024/12/26/paper/Retrofitting-XoM-for-Stripped-Binaries-without/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://passmoon.github.io" target="_blank">PassMoon</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Paper-note/">Paper note</a></div><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/12/28/paper/readacotr/" title="Readactor_Practical Code Randomization Resilient to Memory Disclosure阅读笔记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Readactor_Practical Code Randomization Resilient to Memory Disclosure阅读笔记</div></div><div class="info-2"><div class="info-item-1">Readactor_Practical Code Randomization Resilient to Memory Disclosure阅读笔记 代码重用攻击，尤其是ROP，对现代软件构成严重威胁。通过细粒度的代码随机化可以防止攻击者构建可靠的代码重用攻击。但现有的解决方案要么容易受到内存泄露的影响，要么在实际的商品系统上部署不切实际。文章提出了一种名为Readactor的新型细粒度代码随机化防御方法，能够有效抵御静态和动态ROP攻击。Readactor区分了直接内存泄露（直接读取代码页）和间接内存泄露（通过数据页上的代码指针推断代码布局）。与之前的方法不同，Readactor能够防御这两种类型的内存泄露。同时，Readactor的技术还能保护静态和动态生成的代码。通过基于编译器的新代码生成范例，利用现代CPU提供的硬件功能实现只执行内存，并隐藏代码指针，防止泄露给攻击者。评估表明，Readactor是实用的，能够保护整个Google Chromium浏览器及其V8 JIT编译器，且性能开销较低，SPEC...</div></div></div></a><a class="pagination-related" href="/2024/12/24/paper/Compiler-assited-Code-Randomization-%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/" title="Compiler-assited Code Randomization 阅读笔记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Compiler-assited Code Randomization 阅读笔记</div></div><div class="info-2"><div class="info-item-1">Compiler-assited Code Randomization 阅读笔记 要解决什么问题 现在的代码随机化防御缺乏不破坏现有软件分发规范的透明且先进的部署模式，...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">PassMoon</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">Retrofitting XoM for Stripped Binaries without Embedded Data Relocation 阅读笔记</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">研究背景</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#a-just-in-time-rop"><span class="toc-number">2.1.</span> <span class="toc-text">A. Just-In-Time ROP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#b-execute-only-memory-defense"><span class="toc-number">2.2.</span> <span class="toc-text">B.Execute-only Memory Defense</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#c-memory-protection-keys"><span class="toc-number">2.3.</span> <span class="toc-text">C.Memory Protection Keys</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#d-%E5%86%85%E6%A0%B8%E7%BA%A7-xom-%E4%BF%9D%E6%8A%A4"><span class="toc-number">2.4.</span> <span class="toc-text">D.内核级 XoM 保护</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">主要思想</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text">论文主要贡献</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">5.</span> <span class="toc-text">模型假设</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">6.</span> <span class="toc-text">模型设计</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">7.</span> <span class="toc-text">模型评估</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E8%AF%84%E4%BC%B0"><span class="toc-number">7.1.</span> <span class="toc-text">安全评估</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#a-unidirectional-disassembly-result-analysis"><span class="toc-number">7.1.1.</span> <span class="toc-text">A. Unidirectional Disassembly Result Analysis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#b-attack-surface-analysis"><span class="toc-number">7.1.2.</span> <span class="toc-text">B. Attack Surface Analysis</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E8%AF%84%E4%BC%B0"><span class="toc-number">7.2.</span> <span class="toc-text">性能评估</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">8.</span> <span class="toc-text">讨论和结论</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E6%A0%B8%E9%83%A8%E5%88%86%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8"><span class="toc-number">8.1.</span> <span class="toc-text">内核部分组件安全</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%9D%E6%8A%A4%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E4%BB%A3%E7%A0%81"><span class="toc-number">8.2.</span> <span class="toc-text">保护动态加载代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E4%BF%9D%E6%8A%A4%E5%AF%86%E9%92%A5-mpk-%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7"><span class="toc-number">8.3.</span> <span class="toc-text">内存保护密钥（MPK）的安全性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AE%BA"><span class="toc-number">8.4.</span> <span class="toc-text">结论</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/28/paper/readacotr/" title="Readactor_Practical Code Randomization Resilient to Memory Disclosure阅读笔记">Readactor_Practical Code Randomization Resilient to Memory Disclosure阅读笔记</a><time datetime="2024-12-28T08:14:55.000Z" title="发表于 2024-12-28 16:14:55">2024-12-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/26/paper/Retrofitting-XoM-for-Stripped-Binaries-without/" title="Retrofitting XoM for Stripped Binaries without Embedded Data Relocation 阅读笔记">Retrofitting XoM for Stripped Binaries without Embedded Data Relocation 阅读笔记</a><time datetime="2024-12-26T06:45:34.000Z" title="发表于 2024-12-26 14:45:34">2024-12-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/24/paper/Compiler-assited-Code-Randomization-%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/" title="Compiler-assited Code Randomization 阅读笔记">Compiler-assited Code Randomization 阅读笔记</a><time datetime="2024-12-24T02:23:38.000Z" title="发表于 2024-12-24 10:23:38">2024-12-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/20/hexo/hexo%E6%98%BE%E7%A4%BA%E6%95%B0%E5%AD%A6%E5%85%AC%E5%BC%8F/" title="hexo显示数学公式">hexo显示数学公式</a><time datetime="2024-12-19T16:33:23.000Z" title="发表于 2024-12-20 00:33:23">2024-12-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/18/hexo/hexo-draft/" title="hexo draft">hexo draft</a><time datetime="2024-12-17T16:40:31.000Z" title="发表于 2024-12-18 00:40:31">2024-12-18</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2024 By PassMoon</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>